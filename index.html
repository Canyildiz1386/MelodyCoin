<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online Music Player</title>
</head>
<body>
    <h1>Online Music Player</h1>
    <div id="music-player">
        <button id="select-folder">Select Folder</button>
        <ul id="music-list"></ul>
        <audio id="audio-player" controls></audio>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
    const selectFolderButton = document.getElementById('select-folder');
    const musicListElement = document.getElementById('music-list');
    const audioPlayer = document.getElementById('audio-player');

    if (localStorage.getItem('myMusicDB')) {
        loadMusicList(JSON.parse(localStorage.getItem('myMusicDB')));
    } else {
        selectFolderButton.addEventListener('click', selectFolder);
    }

    function selectFolder() {
        const input = document.createElement('input');
        input.type = 'file';
        input.webkitdirectory = true;
        input.multiple = true;
        input.accept = 'audio/*';

        input.addEventListener('change', function () {
            const files = Array.from(input.files);
            const musicFiles = {};

            files.forEach(file => {
                // Filter to ensure it's an audio file
                if (file.type.startsWith('audio/')) {
                    const pathParts = file.webkitRelativePath.split('/');
                    const folderName = pathParts.slice(1, -1).join('/') || 'Root';
                    
                    if (!musicFiles[folderName]) {
                        musicFiles[folderName] = [];
                    }
                    
                    musicFiles[folderName].push({
                        name: file.name,
                        url: URL.createObjectURL(file)
                    });
                }
            });

            // Remove empty folders
            for (let folder in musicFiles) {
                if (musicFiles[folder].length === 0) {
                    delete musicFiles[folder];
                }
            }

            localStorage.setItem('myMusicDB', JSON.stringify(musicFiles));
            loadMusicList(musicFiles);
        });

        input.click();
    }

    function loadMusicList(musicFiles) {
        musicListElement.innerHTML = '';

        Object.keys(musicFiles).forEach(folderName => {
            const folderHeader = document.createElement('h2');
            folderHeader.textContent = folderName;
            musicListElement.appendChild(folderHeader);

            const ul = document.createElement('ul');
            musicFiles[folderName].forEach(file => {
                const li = document.createElement('li');
                li.textContent = file.name;
                li.addEventListener('click', function () {
                    audioPlayer.src = file.url;
                    audioPlayer.play();
                });
                ul.appendChild(li);
            });
            musicListElement.appendChild(ul);
        });
    }
});

    </script>
</body>
</html>
